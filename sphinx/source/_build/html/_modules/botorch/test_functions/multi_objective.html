

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>botorch.test_functions.multi_objective &mdash; BoTorch  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=ca3e82f4" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            BoTorch
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../acquisition.html">botorch.acquisition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../models.html">botorch.models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generation.html">botorch.generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../posteriors.html">botorch.posteriors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../optim.html">botorch.optim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../fit.html">botorch.fit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sampling.html">botorch.sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cross_validation.html">botorch.cross_validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../settings.html">botorch.settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../logging.html">botorch.logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../test_functions.html">botorch.test_functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../test_utils.html">botorch.test_utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../exceptions.html">botorch.exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../utils.html">botorch.utils</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">BoTorch</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">botorch.test_functions.multi_objective</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for botorch.test_functions.multi_objective</h1><div class="highlight"><pre>
<span></span><span class="ch">#! /usr/bin/env python3</span>
<span class="c1"># Copyright (c) Meta Platforms, Inc. and affiliates.</span>
<span class="c1">#</span>
<span class="c1"># This source code is licensed under the MIT license found in the</span>
<span class="c1"># LICENSE file in the root directory of this source tree.</span>

<span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Multi-objective optimization benchmark problems.</span>

<span class="sd">References</span>

<span class="sd">.. [Daulton2022]</span>
<span class="sd">    S. Daulton, S. Cakmak, M. Balandat, M. A. Osborne, E. Zhou, and E. Bakshy.</span>
<span class="sd">    Robust Multi-Objective Bayesian Optimization Under Input Noise.</span>
<span class="sd">    Proceedings of the 39th International Conference on Machine Learning, 2022.</span>

<span class="sd">.. [Deb2005dtlz]</span>
<span class="sd">    K. Deb, L. Thiele, M. Laumanns, E. Zitzler, A. Abraham, L. Jain, and</span>
<span class="sd">    R. Goldberg. Scalable test problems for evolutionary multi-objective</span>
<span class="sd">    optimization. Evolutionary Multiobjective Optimization, Springer-Verlag,</span>
<span class="sd">    pp. 105-145, 2005.</span>

<span class="sd">.. [Deb2005robust]</span>
<span class="sd">    K. Deb and H. Gupta. Searching for Robust Pareto-Optimal Solutions in</span>
<span class="sd">    Multi-objective Optimization. Evolutionary Multi-Criterion Optimization,</span>
<span class="sd">    Springer-Berlin, pp. 150-164, 2005.</span>

<span class="sd">.. [Frohlich2020]</span>
<span class="sd">    L. Frohlich, E. Klenske, J. Vinogradska, C. Daniel, and M. Zeilinger.</span>
<span class="sd">    Noisy-Input Entropy Search for Efficient Robust Bayesian Optimization.</span>
<span class="sd">    Proceedings of the Twenty Third International Conference on Artificial</span>
<span class="sd">    Intelligence and Statistics, PMLR 108:2262-2272, 2020.</span>

<span class="sd">.. [GarridoMerchan2020]</span>
<span class="sd">    E. C. Garrido-Merch ́an and D. Hern ́andez-Lobato. Parallel Predictive Entropy</span>
<span class="sd">    Search for Multi-objective Bayesian Optimization with Constraints.</span>
<span class="sd">    arXiv e-prints, arXiv:2004.00601, Apr. 2020.</span>

<span class="sd">.. [Gelbart2014]</span>
<span class="sd">    Michael A. Gelbart, Jasper Snoek, and Ryan P. Adams. 2014. Bayesian</span>
<span class="sd">    optimization with unknown constraints. In Proceedings of the Thirtieth</span>
<span class="sd">    Conference on Uncertainty in Artificial Intelligence (UAI’14).</span>
<span class="sd">    AUAI Press, Arlington, Virginia, USA, 250–259.</span>

<span class="sd">.. [Liang2021]</span>
<span class="sd">    Q. Liang and L. Lai, Scalable Bayesian Optimization Accelerates Process</span>
<span class="sd">    Optimization of Penicillin Production. NeurIPS 2021 AI for Science Workshop, 2021.</span>

<span class="sd">.. [Ma2019]</span>
<span class="sd">    Z. Ma and Y. Wang. Evolutionary Constrained Multiobjective Optimization:</span>
<span class="sd">    Test Suite Construction and Performance Comparisons. IEEE Transactions</span>
<span class="sd">    on Evolutionary Computation, 23(6):972–986, December 2019.</span>

<span class="sd">.. [Oszycka1995]</span>
<span class="sd">    A. Osyczka and S. Kundu. A new method to solve generalized</span>
<span class="sd">    multicriteria optimization problems using the simple genetic algorithm.</span>
<span class="sd">    In Structural Optimization 10. 94–99, 1995.</span>

<span class="sd">.. [Tanabe2020]</span>
<span class="sd">    Ryoji Tanabe and Hisao Ishibuchi. An easy-to-use real-world multi-objective</span>
<span class="sd">    optimization problem suite, Applied Soft Computing,Volume 89, 2020.</span>

<span class="sd">.. [Yang2019a]</span>
<span class="sd">    K. Yang, M. Emmerich, A. Deutz, and T. Bäck. Multi-Objective Bayesian</span>
<span class="sd">    Global Optimization using expected hypervolume improvement gradient.</span>
<span class="sd">    Swarm and evolutionary computation 44, pp. 945--956, 2019.</span>

<span class="sd">.. [Zitzler2000]</span>
<span class="sd">    E. Zitzler, K. Deb, and L. Thiele. Comparison of multiobjective</span>
<span class="sd">    evolutionary algorithms: Empirical results. Evolutionary Computation, vol.</span>
<span class="sd">    8, no. 2,pp. 173–195, 2000.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">pi</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">botorch.exceptions.errors</span><span class="w"> </span><span class="kn">import</span> <span class="n">UnsupportedError</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">botorch.test_functions.base</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">ConstrainedBaseTestProblem</span><span class="p">,</span>
    <span class="n">MultiObjectiveTestProblem</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">botorch.test_functions.synthetic</span><span class="w"> </span><span class="kn">import</span> <span class="n">Branin</span><span class="p">,</span> <span class="n">Levy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">botorch.utils.sampling</span><span class="w"> </span><span class="kn">import</span> <span class="n">sample_hypersphere</span><span class="p">,</span> <span class="n">sample_simplex</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">botorch.utils.transforms</span><span class="w"> </span><span class="kn">import</span> <span class="n">unnormalize</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">gamma</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torch</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tensor</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">torch.distributions</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultivariateNormal</span>


<div class="viewcode-block" id="BraninCurrin">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.BraninCurrin">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">BraninCurrin</span><span class="p">(</span><span class="n">MultiObjectiveTestProblem</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Two objective problem composed of the Branin and Currin functions.</span>

<span class="sd">    Branin (rescaled):</span>

<span class="sd">        f(x) = (</span>
<span class="sd">        15*x_1 - 5.1 * (15 * x_0 - 5) ** 2 / (4 * pi ** 2) + 5 * (15 * x_0 - 5)</span>
<span class="sd">        / pi - 5</span>
<span class="sd">        ) ** 2 + (10 - 10 / (8 * pi)) * cos(15 * x_0 - 5))</span>

<span class="sd">    Currin:</span>

<span class="sd">        f(x) = (1 - exp(-1 / (2 * x_1))) * (</span>
<span class="sd">        2300 * x_0 ** 3 + 1900 * x_0 ** 2 + 2092 * x_0 + 60</span>
<span class="sd">        ) / 100 * x_0 ** 3 + 500 * x_0 ** 2 + 4 * x_0 + 20</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dim</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">num_objectives</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)]</span>
    <span class="n">_ref_point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">18.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">]</span>
    <span class="n">_max_hv</span> <span class="o">=</span> <span class="mf">59.36011874867746</span>  <span class="c1"># this is approximated using NSGA-II</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">noise_std</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">negate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">dtype</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">double</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            noise_std: Standard deviation of the observation noise.</span>
<span class="sd">            negate: If True, negate the objectives.</span>
<span class="sd">            dtype: The dtype that is used for the bounds of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">noise_std</span><span class="o">=</span><span class="n">noise_std</span><span class="p">,</span> <span class="n">negate</span><span class="o">=</span><span class="n">negate</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_branin</span> <span class="o">=</span> <span class="n">Branin</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_rescaled_branin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="c1"># return to Branin bounds</span>
        <span class="n">x_0</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">5</span>
        <span class="n">x_1</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_branin</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">x_0</span><span class="p">,</span> <span class="n">x_1</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_currin</span><span class="p">(</span><span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">x_0</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">x_1</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">factor1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x_1</span><span class="p">))</span>
        <span class="n">numer</span> <span class="o">=</span> <span class="mi">2300</span> <span class="o">*</span> <span class="n">x_0</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1900</span> <span class="o">*</span> <span class="n">x_0</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2092</span> <span class="o">*</span> <span class="n">x_0</span> <span class="o">+</span> <span class="mi">60</span>
        <span class="n">denom</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">x_0</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">500</span> <span class="o">*</span> <span class="n">x_0</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">x_0</span> <span class="o">+</span> <span class="mi">20</span>
        <span class="k">return</span> <span class="n">factor1</span> <span class="o">*</span> <span class="n">numer</span> <span class="o">/</span> <span class="n">denom</span>

<div class="viewcode-block" id="BraninCurrin.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.BraninCurrin.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="c1"># branin rescaled with inputsto [0,1]^2</span>
        <span class="n">branin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rescaled_branin</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
        <span class="n">currin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currin</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">branin</span><span class="p">,</span> <span class="n">currin</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="DH">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DH">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DH</span><span class="p">(</span><span class="n">MultiObjectiveTestProblem</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Base class for DH problems for robust multi-objective optimization.</span>

<span class="sd">    In their paper, [Deb2005robust]_ consider these problems under a mean-robustness</span>
<span class="sd">    setting, and use uniformly distributed input perturbations from the box with</span>
<span class="sd">    edge lengths `delta_0 = delta`, `delta_i = 2 * delta, i &gt; 0`, with `delta` ranging</span>
<span class="sd">    up to `0.01` for DH1 and DH2, and `delta = 0.03` for DH3 and DH4.</span>

<span class="sd">    These are d-dimensional problems with two objectives:</span>

<span class="sd">        f_0(x) = x_0</span>
<span class="sd">        f_1(x) = h(x) + g(x) * S(x) for DH1 and DH2</span>
<span class="sd">        f_1(x) = h(x) * (g(x) + S(x)) for DH3 and DH4</span>

<span class="sd">    The goal is to minimize both objectives. See [Deb2005robust]_ for more details</span>
<span class="sd">    on DH. The reference points were set using `infer_reference_point`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">num_objectives</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">_ref_point</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]</span>
    <span class="n">_x_1_lb</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">_area_under_curve</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">_min_dim</span><span class="p">:</span> <span class="nb">int</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">noise_std</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">negate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">dtype</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">double</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            dim: The (input) dimension.</span>
<span class="sd">            noise_std: Standard deviation of the observation noise.</span>
<span class="sd">            negate: If True, negate the function.</span>
<span class="sd">            dtype: The dtype that is used for the bounds of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">dim</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_min_dim</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;dim must be &gt;= </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_min_dim</span><span class="si">}</span><span class="s2">, but got dim=</span><span class="si">{</span><span class="n">dim</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_x_1_lb</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span>
            <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="c1"># max_hv is the area of the box minus the area of the curve formed by the PF.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_max_hv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ref_point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ref_point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_area_under_curve</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">noise_std</span><span class="o">=</span><span class="n">noise_std</span><span class="p">,</span> <span class="n">negate</span><span class="o">=</span><span class="n">negate</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_h</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># pragma: no cover</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_g</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># pragma: no cover</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_S</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># pragma: no cover</span></div>



<div class="viewcode-block" id="DH1">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DH1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DH1</span><span class="p">(</span><span class="n">DH</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;DH1 test problem.</span>

<span class="sd">    d-dimensional problem evaluated on `[0, 1] x [-1, 1]^{d-1}`:</span>

<span class="sd">        f_0(x) = x_0</span>
<span class="sd">        f_1(x) = h(x_0) + g(x) * S(x_0)</span>
<span class="sd">        h(x_0) = 1 - x_0^2</span>
<span class="sd">        g(x) = \sum_{i=1}^{d-1} (10 + x_i^2 - 10 * cos(4 * pi * x_i))</span>
<span class="sd">        S(x_0) = alpha / (0.2 + x_0) + beta * x_0^2</span>

<span class="sd">    where alpha = 1 and beta = 1.</span>

<span class="sd">    The Pareto front corresponds to the equation `f_1 = 1 - f_0^2`, and it is found at</span>
<span class="sd">    `x_i = 0` for `i &gt; 0` and any value of `x_0` in `(0, 1]`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">_x_1_lb</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">_area_under_curve</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="mf">3.0</span>
    <span class="n">_min_dim</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_h</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_g</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">x_1_to</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
            <span class="mi">10</span> <span class="o">+</span> <span class="n">x_1_to</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">x_1_to</span><span class="p">),</span>
            <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_S</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">x_0</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.2</span> <span class="o">+</span> <span class="n">x_0</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">*</span> <span class="n">x_0</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<div class="viewcode-block" id="DH1.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DH1.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">f_0</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="c1"># This may encounter 0 / 0, which we set to 0.</span>
        <span class="n">f_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">nan_to_num</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_g</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_S</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">f_0</span><span class="p">,</span> <span class="n">f_1</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="DH2">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DH2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DH2</span><span class="p">(</span><span class="n">DH1</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;DH2 test problem.</span>

<span class="sd">    This is identical to DH1 except for having `beta = 10.0`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">beta</span> <span class="o">=</span> <span class="mf">10.0</span></div>



<div class="viewcode-block" id="DH3">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DH3">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DH3</span><span class="p">(</span><span class="n">DH</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;DH3 test problem.</span>

<span class="sd">    d-dimensional problem evaluated on `[0, 1]^2 x [-1, 1]^{d-2}`:</span>

<span class="sd">        f_0(x) = x_0</span>
<span class="sd">        f_1(x) = h(x_1) * (g(x) + S(x_0))</span>
<span class="sd">        h(x_1) = 2 - 0.8 * exp(-((x_1 - 0.35) / 0.25)^2) - exp(-((x_1 - 0.85) / 0.03)^2)</span>
<span class="sd">        g(x) = \sum_{i=2}^{d-1} (50 * x_i^2)</span>
<span class="sd">        S(x_0) = 1 - sqrt(x_0)</span>

<span class="sd">    The Pareto front is found at `x_i = 0` for `i &gt; 1`. There&#39;s a local and a global</span>
<span class="sd">    Pareto front, which are found at `x_1 = 0.35` and `x_1 = 0.85`, respectively.</span>
<span class="sd">    The approximate relationships between the objectives at local and global Pareto</span>
<span class="sd">    fronts are given by `f_1 = 1.2 (1 - sqrt(f_0))` and `f_1 = 1 - f_0`, respectively.</span>
<span class="sd">    The specific values on the Pareto fronts can be found by varying `x_0`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_x_1_lb</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">_area_under_curve</span> <span class="o">=</span> <span class="mf">0.328449169794718</span>
    <span class="n">_min_dim</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_exp_args</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]:</span>
        <span class="n">exp_arg_1</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.35</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.25</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">exp_arg_2</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.85</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.03</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">exp_arg_1</span><span class="p">,</span> <span class="n">exp_arg_2</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_h</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">exp_arg_1</span><span class="p">,</span> <span class="n">exp_arg_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp_args</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">-</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">exp_arg_1</span><span class="p">)</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">exp_arg_2</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_g</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">50</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_S</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>

<div class="viewcode-block" id="DH3.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DH3.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">f_0</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">f_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_g</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_S</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">f_0</span><span class="p">,</span> <span class="n">f_1</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="DH4">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DH4">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DH4</span><span class="p">(</span><span class="n">DH3</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;DH4 test problem.</span>

<span class="sd">    This is similar to DH3 except that it is evaluated on</span>
<span class="sd">    `[0, 1] x [-0.15, 1] x [-1, 1]^{d-2}` and:</span>

<span class="sd">        h(x_0, x_1) = 2 - x_0 - 0.8 * exp(-((x_0 + x_1 - 0.35) / 0.25)^2)</span>
<span class="sd">        - exp(-((x_0 + x_1 - 0.85) / 0.03)^2)</span>

<span class="sd">    The Pareto front is found at `x_i = 0` for `i &gt; 2`, with the local one being</span>
<span class="sd">    near `x_0 + x_1 = 0.35` and the global one near `x_0 + x_1 = 0.85`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_x_1_lb</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.15</span>
    <span class="n">_area_under_curve</span> <span class="o">=</span> <span class="mf">0.22845</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_h</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">exp_arg_1</span><span class="p">,</span> <span class="n">exp_arg_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exp_args</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">exp_arg_1</span><span class="p">)</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">exp_arg_2</span><span class="p">)</span></div>



<div class="viewcode-block" id="DTLZ">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DTLZ">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DTLZ</span><span class="p">(</span><span class="n">MultiObjectiveTestProblem</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Base class for DTLZ problems.</span>

<span class="sd">    See [Deb2005dtlz]_ for more details on DTLZ.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">num_objectives</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">noise_std</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">negate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">dtype</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">double</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            dim: The (input) dimension of the function.</span>
<span class="sd">            num_objectives: Must be less than dim.</span>
<span class="sd">            noise_std: Standard deviation of the observation noise.</span>
<span class="sd">            negate: If True, negate the function.</span>
<span class="sd">            dtype: The dtype that is used for the bounds of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">dim</span> <span class="o">&lt;=</span> <span class="n">num_objectives</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;dim must be &gt; num_objectives, but got </span><span class="si">{</span><span class="n">dim</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">num_objectives</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span> <span class="o">=</span> <span class="n">num_objectives</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ref_point</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_ref_val</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_objectives</span><span class="p">)]</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">noise_std</span><span class="o">=</span><span class="n">noise_std</span><span class="p">,</span> <span class="n">negate</span><span class="o">=</span><span class="n">negate</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span></div>



<div class="viewcode-block" id="DTLZ1">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DTLZ1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DTLZ1</span><span class="p">(</span><span class="n">DTLZ</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;DLTZ1 test problem.</span>

<span class="sd">    d-dimensional problem evaluated on `[0, 1]^d`:</span>

<span class="sd">        f_0(x) = 0.5 * x_0 * (1 + g(x))</span>
<span class="sd">        f_1(x) = 0.5 * (1 - x_0) * (1 + g(x))</span>
<span class="sd">        g(x) = 100 * \sum_{i=m}^{d-1} (</span>
<span class="sd">        k + (x_i - 0.5)^2 - cos(20 * pi * (x_i - 0.5))</span>
<span class="sd">        )</span>

<span class="sd">    where k = d - m + 1.</span>

<span class="sd">    The pareto front is given by the line (or hyperplane) \sum_i f_i(x) = 0.5.</span>
<span class="sd">    The goal is to minimize both objectives. The reference point comes from [Yang2019]_.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_ref_val</span> <span class="o">=</span> <span class="mf">400.0</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_max_hv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ref_val</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span>

<div class="viewcode-block" id="DTLZ1.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DTLZ1.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">X_m</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="p">:]</span>
        <span class="n">X_m_minus_half</span> <span class="o">=</span> <span class="n">X_m</span> <span class="o">-</span> <span class="mf">0.5</span>
        <span class="n">sum_term</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">X_m_minus_half</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">X_m_minus_half</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">g_X_m</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">+</span> <span class="n">sum_term</span><span class="p">)</span>
        <span class="n">g_X_m_term</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">g_X_m</span><span class="p">)</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span><span class="p">):</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span>
            <span class="n">f_i</span> <span class="o">=</span> <span class="n">g_X_m_term</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">f_i</span> <span class="o">*=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span>
            <span class="n">fs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f_i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="DTLZ1.gen_pareto_front">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DTLZ1.gen_pareto_front">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">gen_pareto_front</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Generate `n` pareto optimal points.</span>

<span class="sd">        The pareto points randomly sampled from the hyperplane sum_i f(x_i) = 0.5.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f_X</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sample_simplex</span><span class="p">(</span>
            <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
            <span class="n">d</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span><span class="p">,</span>
            <span class="n">qmc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_point</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
            <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_point</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">negate</span><span class="p">:</span>
            <span class="n">f_X</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">return</span> <span class="n">f_X</span></div>
</div>



<div class="viewcode-block" id="DTLZ2">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DTLZ2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DTLZ2</span><span class="p">(</span><span class="n">DTLZ</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;DLTZ2 test problem.</span>

<span class="sd">    d-dimensional problem evaluated on `[0, 1]^d`:</span>

<span class="sd">        f_0(x) = (1 + g(x)) * cos(x_0 * pi / 2)</span>
<span class="sd">        f_1(x) = (1 + g(x)) * sin(x_0 * pi / 2)</span>
<span class="sd">        g(x) = \sum_{i=m}^{d-1} (x_i - 0.5)^2</span>

<span class="sd">    The pareto front is given by the unit hypersphere \sum{i} f_i^2 = 1.</span>
<span class="sd">    Note: the pareto front is completely concave. The goal is to minimize</span>
<span class="sd">    both objectives.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_ref_val</span> <span class="o">=</span> <span class="mf">1.1</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_max_hv</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="c1"># hypercube - volume of hypersphere in R^d such that all coordinates are</span>
        <span class="c1"># positive</span>
        <span class="n">hypercube_vol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ref_val</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span>
        <span class="n">pos_hypersphere_vol</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">**</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="o">/</span> <span class="n">gamma</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="o">/</span> <span class="mi">2</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">hypercube_vol</span> <span class="o">-</span> <span class="n">pos_hypersphere_vol</span>

<div class="viewcode-block" id="DTLZ2.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DTLZ2.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">X_m</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="p">:]</span>
        <span class="n">g_X</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_m</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">g_X_plus1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">g_X</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">pi_over_2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span><span class="p">):</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span>
            <span class="n">f_i</span> <span class="o">=</span> <span class="n">g_X_plus1</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
            <span class="n">f_i</span> <span class="o">*=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="n">idx</span><span class="p">]</span> <span class="o">*</span> <span class="n">pi_over_2</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">f_i</span> <span class="o">*=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">*</span> <span class="n">pi_over_2</span><span class="p">)</span>
            <span class="n">fs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f_i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="DTLZ2.gen_pareto_front">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DTLZ2.gen_pareto_front">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">gen_pareto_front</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Generate `n` pareto optimal points.</span>

<span class="sd">        The pareto points are randomly sampled from the hypersphere&#39;s</span>
<span class="sd">        positive section.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f_X</span> <span class="o">=</span> <span class="n">sample_hypersphere</span><span class="p">(</span>
            <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
            <span class="n">d</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span><span class="p">,</span>
            <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_point</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
            <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_point</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
            <span class="n">qmc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">negate</span><span class="p">:</span>
            <span class="n">f_X</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">return</span> <span class="n">f_X</span></div>
</div>



<div class="viewcode-block" id="DTLZ3">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DTLZ3">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DTLZ3</span><span class="p">(</span><span class="n">DTLZ2</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;DTLZ3 test problem.</span>

<span class="sd">    d-dimensional problem evaluated on `[0, 1]^d`:</span>

<span class="sd">        f_0(x) = (1 + g(x)) * cos(x_0 * pi / 2)</span>
<span class="sd">        f_1(x) = (1 + g(x)) * sin(x_0 * pi / 2)</span>
<span class="sd">        g(x) = 100 * [k + \sum_{i=m}^{n-1} (x_i - 0.5)^2 - cos(20 * pi * (x_i - 0.5))]</span>

<span class="sd">    `g(x)` introduces (`3k−1`) local Pareto fronts that are parallel to</span>
<span class="sd">    the one global Pareto-optimal front.</span>

<span class="sd">    The global Pareto-optimal front corresponds to x_i = 0.5 for x_i in X_m.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_ref_val</span> <span class="o">=</span> <span class="mf">10000.0</span>

<div class="viewcode-block" id="DTLZ3.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DTLZ3.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">X_m</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="p">:]</span>
        <span class="n">g_X</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">X_m</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="o">+</span> <span class="p">((</span><span class="n">X_m</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">20</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">X_m</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">g_X_plus1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">g_X</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">pi_over_2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span><span class="p">):</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span>
            <span class="n">f_i</span> <span class="o">=</span> <span class="n">g_X_plus1</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
            <span class="n">f_i</span> <span class="o">*=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="n">idx</span><span class="p">]</span> <span class="o">*</span> <span class="n">pi_over_2</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">f_i</span> <span class="o">*=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">*</span> <span class="n">pi_over_2</span><span class="p">)</span>
            <span class="n">fs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f_i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="DTLZ4">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DTLZ4">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DTLZ4</span><span class="p">(</span><span class="n">DTLZ2</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;DTLZ4 test problem.</span>

<span class="sd">    This is the same as DTLZ2, but with alpha=100 as the exponent,</span>
<span class="sd">    resulting in dense solutions near the f_M-f_1 plane.</span>

<span class="sd">    The global Pareto-optimal front corresponds to x_i = 0.5 for x_i in X_m.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_alpha</span> <span class="o">=</span> <span class="mf">100.0</span></div>



<div class="viewcode-block" id="DTLZ5">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DTLZ5">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DTLZ5</span><span class="p">(</span><span class="n">DTLZ</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;DTLZ5 test problem.</span>

<span class="sd">    d-dimensional problem evaluated on `[0, 1]^d`:</span>

<span class="sd">        f_0(x) = (1 + g(x)) * cos(theta_0 * pi / 2)</span>
<span class="sd">        f_1(x) = (1 + g(x)) * sin(theta_0 * pi / 2)</span>
<span class="sd">        theta_i = pi / (4 * (1 + g(X_m)) * (1 + 2 * g(X_m) * x_i)) for i = 1, ... , M-2</span>
<span class="sd">        g(x) = \sum_{i=m}^{d-1} (x_i - 0.5)^2</span>

<span class="sd">    The global Pareto-optimal front corresponds to x_i = 0.5 for x_i in X_m.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_ref_val</span> <span class="o">=</span> <span class="mf">10.0</span>

<div class="viewcode-block" id="DTLZ5.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DTLZ5.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">X_m</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="p">:]</span>
        <span class="n">X_</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span><span class="p">]</span>
        <span class="n">g_X</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_m</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">g_X</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">g_X</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">X_</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="n">theta</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">pi_over_2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">g_X_plus1</span> <span class="o">=</span> <span class="n">g_X</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span><span class="p">):</span>
            <span class="n">f_i</span> <span class="o">=</span> <span class="n">g_X_plus1</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
            <span class="n">f_i</span> <span class="o">*=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span> <span class="n">theta</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">pi_over_2</span><span class="p">)</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">f_i</span> <span class="o">*=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">theta</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">pi_over_2</span><span class="p">)</span>
            <span class="n">fs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f_i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">fs</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="DTLZ7">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DTLZ7">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DTLZ7</span><span class="p">(</span><span class="n">DTLZ</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;DTLZ7 test problem.</span>

<span class="sd">    d-dimensional problem evaluated on `[0, 1]^d`:</span>
<span class="sd">        f_0(x) = x_0</span>
<span class="sd">        f_1(x) = x_1</span>
<span class="sd">        ...</span>
<span class="sd">        f_{M-1}(x) = (1 + g(X_m)) * h(f_0, f_1, ..., f_{M-2}, g, x)</span>
<span class="sd">        h(f_0, f_1, ..., f_{M-2}, g, x) =</span>
<span class="sd">        M - sum_{i=0}^{M-2} f_i(x)/(1+g(x)) * (1 + sin(3 * pi * f_i(x)))</span>

<span class="sd">    This test problem has 2M-1 disconnected Pareto-optimal regions in the search space.</span>

<span class="sd">    The pareto frontier corresponds to X_m = 0.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_ref_val</span> <span class="o">=</span> <span class="mf">15.0</span>

<div class="viewcode-block" id="DTLZ7.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DTLZ7.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">f</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">])</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">g_X</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">9</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">k</span> <span class="p">:],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
            <span class="n">f</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">g_X</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f</span><span class="p">)),</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">f</span><span class="p">,</span> <span class="p">((</span><span class="mi">1</span> <span class="o">+</span> <span class="n">g_X</span><span class="p">)</span> <span class="o">*</span> <span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="GMM">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.GMM">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">GMM</span><span class="p">(</span><span class="n">MultiObjectiveTestProblem</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;A test problem where each objective is a Gaussian mixture model.</span>

<span class="sd">    This implementation is adapted from the single objective version (proposed by</span>
<span class="sd">    [Frohlich2020]_) at</span>
<span class="sd">    https://github.com/boschresearch/NoisyInputEntropySearch/blob/master/</span>
<span class="sd">    core/util/objectives.py.</span>

<span class="sd">    See [Daulton2022]_ for details on this multi-objective problem.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dim</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">noise_std</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">negate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">num_objectives</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">dtype</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">double</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            noise_std: Standard deviation of the observation noise.</span>
<span class="sd">            negate: If True, negate the objectives.</span>
<span class="sd">            num_objectives: The number of objectives.</span>
<span class="sd">            dtype: The dtype that is used for the bounds of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">num_objectives</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">UnsupportedError</span><span class="p">(</span><span class="s2">&quot;GMM only currently supports 2 to 4 objectives.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ref_point</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.2338</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2211</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">num_objectives</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ref_point</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5180</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">num_objectives</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ref_point</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1866</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span> <span class="o">=</span> <span class="n">num_objectives</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">noise_std</span><span class="o">=</span><span class="n">noise_std</span><span class="p">,</span> <span class="n">negate</span><span class="o">=</span><span class="n">negate</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">gmm_pos</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">[[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]],</span>
                <span class="p">[[</span><span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]],</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">gmm_var</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">]])</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">gmm_norm</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">gmm_var</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">num_objectives</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">gmm_pos</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span>
                <span class="p">[</span><span class="n">gmm_pos</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[[</span><span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.21</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.86</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">]]])],</span>
                <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">gmm_var</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span>
                <span class="p">[</span><span class="n">gmm_var</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">]])</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span>
            <span class="p">)</span>
            <span class="n">gmm_norm</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">gmm_norm</span><span class="p">,</span>
                    <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">gmm_var</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]]),</span>
                <span class="p">],</span>
                <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">num_objectives</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">gmm_pos</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span>
                <span class="p">[</span><span class="n">gmm_pos</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[[</span><span class="mf">0.09</span><span class="p">,</span> <span class="mf">0.19</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.44</span><span class="p">,</span> <span class="mf">0.72</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.89</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">]]])],</span>
                <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">gmm_var</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span>
                <span class="p">[</span><span class="n">gmm_var</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.09</span><span class="p">]])</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span>
            <span class="p">)</span>
            <span class="n">gmm_norm</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">gmm_norm</span><span class="p">,</span>
                    <span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">*</span> <span class="n">gmm_var</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]]),</span>
                <span class="p">],</span>
                <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">gmm_covar</span> <span class="o">=</span> <span class="n">gmm_var</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">*</span><span class="n">gmm_var</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span>
            <span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">gmm_var</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">gmm_var</span><span class="o">.</span><span class="n">device</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_buffer</span><span class="p">(</span><span class="s2">&quot;gmm_pos&quot;</span><span class="p">,</span> <span class="n">gmm_pos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_buffer</span><span class="p">(</span><span class="s2">&quot;gmm_covar&quot;</span><span class="p">,</span> <span class="n">gmm_covar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_buffer</span><span class="p">(</span><span class="s2">&quot;gmm_norm&quot;</span><span class="p">,</span> <span class="n">gmm_norm</span><span class="p">)</span>

<div class="viewcode-block" id="GMM.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.GMM.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Evaluate the GMMs.&quot;&quot;&quot;</span>
        <span class="c1"># This needs to be reinstantiated because MVN apparently does not</span>
        <span class="c1"># have a `to` method to make it device/dtype agnostic.</span>
        <span class="n">mvn</span> <span class="o">=</span> <span class="n">MultivariateNormal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gmm_pos</span><span class="p">,</span> <span class="n">covariance_matrix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gmm_covar</span><span class="p">)</span>
        <span class="n">view_shape</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gmm_pos</span><span class="o">.</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmm_pos</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>
        <span class="p">)</span>
        <span class="n">expand_shape</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmm_pos</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">pdf_X</span> <span class="o">=</span> <span class="n">mvn</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">view_shape</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">expand_shape</span><span class="p">))</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
        <span class="c1"># Multiply by -1 to make this a minimization problem by default</span>
        <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gmm_norm</span> <span class="o">*</span> <span class="n">pdf_X</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="Penicillin">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.Penicillin">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Penicillin</span><span class="p">(</span><span class="n">MultiObjectiveTestProblem</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;A penicillin production simulator from [Liang2021]_.</span>

<span class="sd">    This implementation is adapted from</span>
<span class="sd">    https://github.com/HarryQL/TuRBO-Penicillin.</span>

<span class="sd">    The goal is to maximize the penicillin yield while minimizing</span>
<span class="sd">    time to ferment and the CO2 byproduct.</span>

<span class="sd">    The function is defined for minimization of all objectives.</span>

<span class="sd">    The reference point was set using the `infer_reference_point` heuristic</span>
<span class="sd">    on the Pareto frontier obtained via NSGA-II.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_max_hv</span> <span class="o">=</span> <span class="mf">2183455.909507436</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">num_objectives</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">_bounds</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="mf">60.0</span><span class="p">,</span> <span class="mf">120.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">18.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">293.0</span><span class="p">,</span> <span class="mf">303.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">18.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">500.0</span><span class="p">,</span> <span class="mf">700.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">_ref_point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">25.935</span><span class="p">,</span> <span class="mf">57.612</span><span class="p">,</span> <span class="mf">935.5</span><span class="p">]</span>

    <span class="n">Y_xs</span> <span class="o">=</span> <span class="mf">0.45</span>
    <span class="n">Y_ps</span> <span class="o">=</span> <span class="mf">0.90</span>
    <span class="n">K_1</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">K_2</span> <span class="o">=</span> <span class="mi">7</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">m_X</span> <span class="o">=</span> <span class="mf">0.014</span>
    <span class="n">alpha_1</span> <span class="o">=</span> <span class="mf">0.143</span>
    <span class="n">alpha_2</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">alpha_3</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">mu_X</span> <span class="o">=</span> <span class="mf">0.092</span>
    <span class="n">K_X</span> <span class="o">=</span> <span class="mf">0.15</span>
    <span class="n">mu_p</span> <span class="o">=</span> <span class="mf">0.005</span>
    <span class="n">K_p</span> <span class="o">=</span> <span class="mf">0.0002</span>
    <span class="n">K_I</span> <span class="o">=</span> <span class="mf">0.10</span>
    <span class="n">K</span> <span class="o">=</span> <span class="mf">0.04</span>
    <span class="n">k_g</span> <span class="o">=</span> <span class="mf">7.0</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="mi">3</span>
    <span class="n">E_g</span> <span class="o">=</span> <span class="mf">5100.0</span>
    <span class="n">k_d</span> <span class="o">=</span> <span class="mf">10.0</span><span class="o">**</span><span class="mi">33</span>
    <span class="n">E_d</span> <span class="o">=</span> <span class="mf">50000.0</span>
    <span class="n">lambd</span> <span class="o">=</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">T_v</span> <span class="o">=</span> <span class="mf">273.0</span>  <span class="c1"># Kelvin</span>
    <span class="n">T_o</span> <span class="o">=</span> <span class="mf">373.0</span>
    <span class="n">R</span> <span class="o">=</span> <span class="mf">1.9872</span>  <span class="c1"># CAL/(MOL K)</span>
    <span class="n">V_max</span> <span class="o">=</span> <span class="mf">180.0</span>

<div class="viewcode-block" id="Penicillin.penicillin_vectorized">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.Penicillin.penicillin_vectorized">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">penicillin_vectorized</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">X_input</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Penicillin simulator, simplified and vectorized.</span>

<span class="sd">        The 7 input parameters are (in order): culture volume, biomass</span>
<span class="sd">        concentration, temperature, glucose concentration, substrate feed</span>
<span class="sd">        rate, substrate feed concentration, and H+ concentration.</span>

<span class="sd">        Args:</span>
<span class="sd">            X_input: A `n x 7`-dim tensor of inputs.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An `n x 3`-dim tensor of (negative) penicillin yield, CO2 and time.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">V</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">s_f</span><span class="p">,</span> <span class="n">H_</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X_input</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">P</span><span class="p">,</span> <span class="n">CO2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">V</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">H_</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="o">-</span><span class="n">H_</span><span class="p">)</span>

        <span class="n">active</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">.</span><span class="n">bool</span><span class="p">()</span>
        <span class="n">t_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="mi">2500</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2501</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">active</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">F_loss</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">V</span><span class="p">[</span><span class="n">active</span><span class="p">]</span>
                <span class="o">*</span> <span class="bp">cls</span><span class="o">.</span><span class="n">lambd</span>
                <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">expm1</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="p">((</span><span class="n">T</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">-</span> <span class="bp">cls</span><span class="o">.</span><span class="n">T_o</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">T_v</span> <span class="o">-</span> <span class="bp">cls</span><span class="o">.</span><span class="n">T_o</span><span class="p">)))</span>
            <span class="p">)</span>
            <span class="n">dV_dt</span> <span class="o">=</span> <span class="n">F</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">-</span> <span class="n">F_loss</span>
            <span class="n">mu</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">mu_X</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">cls</span><span class="o">.</span><span class="n">K_1</span> <span class="o">/</span> <span class="n">H</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">+</span> <span class="n">H</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">/</span> <span class="bp">cls</span><span class="o">.</span><span class="n">K_2</span><span class="p">))</span>
                <span class="o">*</span> <span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">K_X</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">+</span> <span class="n">S</span><span class="p">[</span><span class="n">active</span><span class="p">]))</span>
                <span class="o">*</span> <span class="p">(</span>
                    <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">k_g</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">cls</span><span class="o">.</span><span class="n">E_g</span> <span class="o">/</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">[</span><span class="n">active</span><span class="p">])))</span>
                    <span class="o">-</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">k_d</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">cls</span><span class="o">.</span><span class="n">E_d</span> <span class="o">/</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">R</span> <span class="o">*</span> <span class="n">T</span><span class="p">[</span><span class="n">active</span><span class="p">])))</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="n">dX_dt</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">/</span> <span class="n">V</span><span class="p">[</span><span class="n">active</span><span class="p">])</span> <span class="o">*</span> <span class="n">dV_dt</span>
            <span class="n">mu_pp</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">mu_p</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">S</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">K_p</span> <span class="o">+</span> <span class="n">S</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">+</span> <span class="n">S</span><span class="p">[</span><span class="n">active</span><span class="p">]</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="bp">cls</span><span class="o">.</span><span class="n">K_I</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">dS_dt</span> <span class="o">=</span> <span class="p">(</span>
                <span class="o">-</span><span class="p">(</span><span class="n">mu</span> <span class="o">/</span> <span class="bp">cls</span><span class="o">.</span><span class="n">Y_xs</span><span class="p">)</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">active</span><span class="p">]</span>
                <span class="o">-</span> <span class="p">(</span><span class="n">mu_pp</span> <span class="o">/</span> <span class="bp">cls</span><span class="o">.</span><span class="n">Y_ps</span><span class="p">)</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">active</span><span class="p">]</span>
                <span class="o">-</span> <span class="bp">cls</span><span class="o">.</span><span class="n">m_X</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">active</span><span class="p">]</span>
                <span class="o">+</span> <span class="n">F</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">*</span> <span class="n">s_f</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">/</span> <span class="n">V</span><span class="p">[</span><span class="n">active</span><span class="p">]</span>
                <span class="o">-</span> <span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">/</span> <span class="n">V</span><span class="p">[</span><span class="n">active</span><span class="p">])</span> <span class="o">*</span> <span class="n">dV_dt</span>
            <span class="p">)</span>
            <span class="n">dP_dt</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">mu_pp</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">active</span><span class="p">])</span>
                <span class="o">-</span> <span class="bp">cls</span><span class="o">.</span><span class="n">K</span> <span class="o">*</span> <span class="n">P</span><span class="p">[</span><span class="n">active</span><span class="p">]</span>
                <span class="o">-</span> <span class="p">(</span><span class="n">P</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">/</span> <span class="n">V</span><span class="p">[</span><span class="n">active</span><span class="p">])</span> <span class="o">*</span> <span class="n">dV_dt</span>
            <span class="p">)</span>
            <span class="n">dCO2_dt</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">alpha_1</span> <span class="o">*</span> <span class="n">dX_dt</span> <span class="o">+</span> <span class="bp">cls</span><span class="o">.</span><span class="n">alpha_2</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">+</span> <span class="bp">cls</span><span class="o">.</span><span class="n">alpha_3</span>

            <span class="c1"># UPDATE</span>
            <span class="n">P</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">+</span> <span class="n">dP_dt</span>  <span class="c1"># Penicillin concentration</span>
            <span class="n">V</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">=</span> <span class="n">V</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">+</span> <span class="n">dV_dt</span>  <span class="c1"># Culture medium volume</span>
            <span class="n">X</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">+</span> <span class="n">dX_dt</span>  <span class="c1"># Biomass concentration</span>
            <span class="n">S</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">+</span> <span class="n">dS_dt</span>  <span class="c1"># Glucose concentration</span>
            <span class="n">CO2</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">=</span> <span class="n">CO2</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">+</span> <span class="n">dCO2_dt</span>  <span class="c1"># CO2 concentration</span>

            <span class="c1"># Update active indices</span>
            <span class="n">full_dpdt</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
            <span class="n">full_dpdt</span><span class="p">[</span><span class="n">active</span><span class="p">]</span> <span class="o">=</span> <span class="n">dP_dt</span>
            <span class="n">inactive</span> <span class="o">=</span> <span class="p">(</span><span class="n">V</span> <span class="o">&gt;</span> <span class="bp">cls</span><span class="o">.</span><span class="n">V_max</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">S</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">full_dpdt</span> <span class="o">&lt;</span> <span class="mf">10e-12</span><span class="p">)</span>
            <span class="n">t_tensor</span><span class="p">[</span><span class="n">inactive</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span>
                <span class="n">t_tensor</span><span class="p">[</span><span class="n">inactive</span><span class="p">],</span> <span class="n">torch</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">t_tensor</span><span class="p">[</span><span class="n">inactive</span><span class="p">],</span> <span class="n">t</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">active</span><span class="p">[</span><span class="n">inactive</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="o">-</span><span class="n">P</span><span class="p">,</span> <span class="n">CO2</span><span class="p">,</span> <span class="n">t_tensor</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="Penicillin.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.Penicillin.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="c1"># This uses in-place operations. Hence, the clone is to avoid modifying</span>
        <span class="c1"># the original X in-place.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">penicillin_vectorized</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">)</span><span class="o">.</span><span class="n">clone</span><span class="p">())</span><span class="o">.</span><span class="n">view</span><span class="p">(</span>
            <span class="o">*</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span>
        <span class="p">)</span></div>
</div>



<div class="viewcode-block" id="ToyRobust">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.ToyRobust">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">ToyRobust</span><span class="p">(</span><span class="n">MultiObjectiveTestProblem</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;A 1D problem where the Pareto frontier is sensitive to input noise.</span>

<span class="sd">    Specifically, the pareto frontier over the nominal objectives is</span>
<span class="sd">    sensitive to input noise. The first objective is a mixture of a linear</span>
<span class="sd">    function and a sinusoidal function, and the second objective is a modified</span>
<span class="sd">    Levy function, where the second parameter is fixed.</span>

<span class="sd">    This function comes from [Daulton2022]_.</span>

<span class="sd">    The reference point was set using the `infer_reference_point`</span>
<span class="sd">    heuristic on the Pareto frontier over a large discrete set of</span>
<span class="sd">    random designs.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dim</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)]</span>
    <span class="n">_ref_point</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">6.1397</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.1942</span><span class="p">]</span>
    <span class="n">num_objectives</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">levy</span> <span class="o">=</span> <span class="n">Levy</span><span class="p">()</span>

<div class="viewcode-block" id="ToyRobust.f_1">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.ToyRobust.f_1">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">f_1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">p1</span> <span class="o">=</span> <span class="mf">2.4</span> <span class="o">-</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">X</span> <span class="o">-</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">p2</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">X</span> <span class="o">-</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">smoother</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="n">X</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span>
        <span class="n">x_mask</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">((</span><span class="mf">0.2</span> <span class="o">-</span> <span class="n">X</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.005</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">p1</span> <span class="o">*</span> <span class="n">x_mask</span> <span class="o">+</span> <span class="n">p2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x_mask</span><span class="p">)</span> <span class="o">+</span> <span class="n">smoother</span><span class="p">)</span> <span class="o">*</span> <span class="mi">30</span> <span class="o">+</span> <span class="mi">30</span></div>


<div class="viewcode-block" id="ToyRobust.f_2">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.ToyRobust.f_2">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">f_2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span>
            <span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">X</span><span class="p">)],</span>
            <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="c1"># Cut out the first part of the function.</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">X</span> <span class="o">*</span> <span class="mf">0.95</span> <span class="o">+</span> <span class="mf">0.03</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">unnormalize</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">levy</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
        <span class="n">Y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">levy</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">Y</span> <span class="o">-=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.75</span>
        <span class="k">return</span> <span class="n">Y</span></div>


<div class="viewcode-block" id="ToyRobust.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.ToyRobust.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">f_1</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">f_2</span><span class="p">(</span><span class="n">X</span><span class="p">)],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="VehicleSafety">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.VehicleSafety">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">VehicleSafety</span><span class="p">(</span><span class="n">MultiObjectiveTestProblem</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Optimize Vehicle crash-worthiness.</span>

<span class="sd">    See [Tanabe2020]_ for details.</span>

<span class="sd">    The reference point is 1.1 * the nadir point from</span>
<span class="sd">    approximate front provided by [Tanabe2020]_.</span>

<span class="sd">    The maximum hypervolume is computed using the approximate</span>
<span class="sd">    pareto front from [Tanabe2020]_.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_ref_point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1864.72022</span><span class="p">,</span> <span class="mf">11.81993945</span><span class="p">,</span> <span class="mf">0.2903999384</span><span class="p">]</span>
    <span class="n">_max_hv</span> <span class="o">=</span> <span class="mf">246.81607081187002</span>
    <span class="n">_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)]</span> <span class="o">*</span> <span class="mi">5</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">num_objectives</span> <span class="o">=</span> <span class="mi">3</span>

<div class="viewcode-block" id="VehicleSafety.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.VehicleSafety.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">X3</span><span class="p">,</span> <span class="n">X4</span><span class="p">,</span> <span class="n">X5</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">1640.2823</span>
            <span class="o">+</span> <span class="mf">2.3573285</span> <span class="o">*</span> <span class="n">X1</span>
            <span class="o">+</span> <span class="mf">2.3220035</span> <span class="o">*</span> <span class="n">X2</span>
            <span class="o">+</span> <span class="mf">4.5688768</span> <span class="o">*</span> <span class="n">X3</span>
            <span class="o">+</span> <span class="mf">7.7213633</span> <span class="o">*</span> <span class="n">X4</span>
            <span class="o">+</span> <span class="mf">4.4559504</span> <span class="o">*</span> <span class="n">X5</span>
        <span class="p">)</span>
        <span class="n">f2</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">6.5856</span>
            <span class="o">+</span> <span class="mf">1.15</span> <span class="o">*</span> <span class="n">X1</span>
            <span class="o">-</span> <span class="mf">1.0427</span> <span class="o">*</span> <span class="n">X2</span>
            <span class="o">+</span> <span class="mf">0.9738</span> <span class="o">*</span> <span class="n">X3</span>
            <span class="o">+</span> <span class="mf">0.8364</span> <span class="o">*</span> <span class="n">X4</span>
            <span class="o">-</span> <span class="mf">0.3695</span> <span class="o">*</span> <span class="n">X1</span> <span class="o">*</span> <span class="n">X4</span>
            <span class="o">+</span> <span class="mf">0.0861</span> <span class="o">*</span> <span class="n">X1</span> <span class="o">*</span> <span class="n">X5</span>
            <span class="o">+</span> <span class="mf">0.3628</span> <span class="o">*</span> <span class="n">X2</span> <span class="o">*</span> <span class="n">X4</span>
            <span class="o">-</span> <span class="mf">0.1106</span> <span class="o">*</span> <span class="n">X1</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="o">-</span> <span class="mf">0.3437</span> <span class="o">*</span> <span class="n">X3</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">0.1764</span> <span class="o">*</span> <span class="n">X4</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">f3</span> <span class="o">=</span> <span class="p">(</span>
            <span class="o">-</span><span class="mf">0.0551</span>
            <span class="o">+</span> <span class="mf">0.0181</span> <span class="o">*</span> <span class="n">X1</span>
            <span class="o">+</span> <span class="mf">0.1024</span> <span class="o">*</span> <span class="n">X2</span>
            <span class="o">+</span> <span class="mf">0.0421</span> <span class="o">*</span> <span class="n">X3</span>
            <span class="o">-</span> <span class="mf">0.0073</span> <span class="o">*</span> <span class="n">X1</span> <span class="o">*</span> <span class="n">X2</span>
            <span class="o">+</span> <span class="mf">0.024</span> <span class="o">*</span> <span class="n">X2</span> <span class="o">*</span> <span class="n">X3</span>
            <span class="o">-</span> <span class="mf">0.0118</span> <span class="o">*</span> <span class="n">X2</span> <span class="o">*</span> <span class="n">X4</span>
            <span class="o">-</span> <span class="mf">0.0204</span> <span class="o">*</span> <span class="n">X3</span> <span class="o">*</span> <span class="n">X4</span>
            <span class="o">-</span> <span class="mf">0.008</span> <span class="o">*</span> <span class="n">X3</span> <span class="o">*</span> <span class="n">X5</span>
            <span class="o">-</span> <span class="mf">0.0241</span> <span class="o">*</span> <span class="n">X2</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="o">+</span> <span class="mf">0.0109</span> <span class="o">*</span> <span class="n">X4</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">f_X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">f_X</span></div>
</div>



<div class="viewcode-block" id="ZDT">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.ZDT">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">ZDT</span><span class="p">(</span><span class="n">MultiObjectiveTestProblem</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Base class for ZDT problems.</span>

<span class="sd">    See [Zitzler2000]_ for more details on ZDT.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_ref_point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">11.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">num_objectives</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">noise_std</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">negate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">dtype</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">double</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            dim: The (input) dimension of the function.</span>
<span class="sd">            num_objectives: Number of objectives. Must not be larger than dim.</span>
<span class="sd">            noise_std: Standard deviation of the observation noise.</span>
<span class="sd">            negate: If True, negate the function.</span>
<span class="sd">            dtype: The dtype that is used for the bounds of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">num_objectives</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> currently only supports 2 objectives.&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">dim</span> <span class="o">&lt;</span> <span class="n">num_objectives</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;dim must be &gt;= num_objectives, but got </span><span class="si">{</span><span class="n">dim</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">num_objectives</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span> <span class="o">=</span> <span class="n">num_objectives</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">)]</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">noise_std</span><span class="o">=</span><span class="n">noise_std</span><span class="p">,</span> <span class="n">negate</span><span class="o">=</span><span class="n">negate</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_g</span><span class="p">(</span><span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">9</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>



<div class="viewcode-block" id="ZDT1">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.ZDT1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">ZDT1</span><span class="p">(</span><span class="n">ZDT</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;ZDT1 test problem.</span>

<span class="sd">    d-dimensional problem evaluated on `[0, 1]^d`:</span>

<span class="sd">        f_0(x) = x_0</span>
<span class="sd">        f_1(x) = g(x) * (1 - sqrt(x_0 / g(x))</span>
<span class="sd">        g(x) = 1 + 9 / (d - 1) * \sum_{i=1}^{d-1} x_i</span>

<span class="sd">    The reference point comes from [Yang2019a]_.</span>

<span class="sd">    The pareto front is convex.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_max_hv</span> <span class="o">=</span> <span class="mi">120</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">3</span>

<div class="viewcode-block" id="ZDT1.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.ZDT1.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">f_0</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_g</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
        <span class="n">f_1</span> <span class="o">=</span> <span class="n">g</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">f_0</span> <span class="o">/</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">f_0</span><span class="p">,</span> <span class="n">f_1</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="ZDT1.gen_pareto_front">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.ZDT1.gen_pareto_front">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">gen_pareto_front</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">f_0</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">device</span>
        <span class="p">)</span>
        <span class="n">f_1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">f_0</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
        <span class="n">f_X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">f_0</span><span class="p">,</span> <span class="n">f_1</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">negate</span><span class="p">:</span>
            <span class="n">f_X</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">return</span> <span class="n">f_X</span></div>
</div>



<div class="viewcode-block" id="ZDT2">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.ZDT2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">ZDT2</span><span class="p">(</span><span class="n">ZDT</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;ZDT2 test problem.</span>

<span class="sd">    d-dimensional problem evaluated on `[0, 1]^d`:</span>

<span class="sd">        f_0(x) = x_0</span>
<span class="sd">        f_1(x) = g(x) * (1 - (x_0 / g(x))^2)</span>
<span class="sd">        g(x) = 1 + 9 / (d - 1) * \sum_{i=1}^{d-1} x_i</span>

<span class="sd">    The reference point comes from [Yang2019a]_.</span>

<span class="sd">    The pareto front is concave.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_max_hv</span> <span class="o">=</span> <span class="mi">120</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">3</span>

<div class="viewcode-block" id="ZDT2.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.ZDT2.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">f_0</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_g</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
        <span class="n">f_1</span> <span class="o">=</span> <span class="n">g</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">f_0</span> <span class="o">/</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">f_0</span><span class="p">,</span> <span class="n">f_1</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="ZDT2.gen_pareto_front">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.ZDT2.gen_pareto_front">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">gen_pareto_front</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">f_0</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">device</span>
        <span class="p">)</span>
        <span class="n">f_1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">f_0</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">f_X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">f_0</span><span class="p">,</span> <span class="n">f_1</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">negate</span><span class="p">:</span>
            <span class="n">f_X</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">return</span> <span class="n">f_X</span></div>
</div>



<div class="viewcode-block" id="ZDT3">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.ZDT3">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">ZDT3</span><span class="p">(</span><span class="n">ZDT</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;ZDT3 test problem.</span>

<span class="sd">    d-dimensional problem evaluated on `[0, 1]^d`:</span>

<span class="sd">        f_0(x) = x_0</span>
<span class="sd">        f_1(x) = 1 - sqrt(x_0 / g(x)) - x_0 / g * sin(10 * pi * x_0)</span>
<span class="sd">        g(x) = 1 + 9 / (d - 1) * \sum_{i=1}^{d-1} x_i</span>

<span class="sd">    The reference point comes from [Yang2019a]_.</span>

<span class="sd">    The pareto front consists of several discontinuous convex parts.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_max_hv</span> <span class="o">=</span> <span class="mf">128.77811613069076060</span>
    <span class="n">_parts</span> <span class="o">=</span> <span class="p">[</span>
        <span class="c1"># this interval includes both end points</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0830015349</span><span class="p">],</span>
        <span class="c1"># this interval includes only the right end points</span>
        <span class="p">[</span><span class="mf">0.1822287280</span><span class="p">,</span> <span class="mf">0.2577623634</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.4093136748</span><span class="p">,</span> <span class="mf">0.4538821041</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.6183967944</span><span class="p">,</span> <span class="mf">0.6525117038</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.8233317983</span><span class="p">,</span> <span class="mf">0.8518328654</span><span class="p">],</span>
    <span class="p">]</span>
    <span class="c1"># nugget to make sure linspace returns elements within the specified range</span>
    <span class="n">_eps</span> <span class="o">=</span> <span class="mf">1e-6</span>

<div class="viewcode-block" id="ZDT3.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.ZDT3.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">f_0</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">g</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_g</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
        <span class="n">f_1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">f_0</span> <span class="o">/</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span> <span class="o">-</span> <span class="n">f_0</span> <span class="o">/</span> <span class="n">g</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">f_0</span><span class="p">,</span> <span class="n">f_1</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="ZDT3.gen_pareto_front">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.ZDT3.gen_pareto_front">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">gen_pareto_front</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">n_parts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parts</span><span class="p">)</span>
        <span class="n">n_per_part</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">full</span><span class="p">(</span>
            <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="n">n_parts</span><span class="p">]),</span>
            <span class="n">n</span> <span class="o">//</span> <span class="n">n_parts</span><span class="p">,</span>
            <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">long</span><span class="p">,</span>
            <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">left_over</span> <span class="o">=</span> <span class="n">n</span> <span class="o">%</span> <span class="n">n_parts</span>
        <span class="n">n_per_part</span><span class="p">[:</span><span class="n">left_over</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">f_0s</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parts</span><span class="p">):</span>
            <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">p</span>
            <span class="n">f_0s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                    <span class="n">left</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eps</span><span class="p">,</span>
                    <span class="n">right</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eps</span><span class="p">,</span>
                    <span class="nb">int</span><span class="p">(</span><span class="n">n_per_part</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span>
                    <span class="n">device</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">device</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="n">f_0</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">f_0s</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">f_1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">f_0</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span> <span class="o">-</span> <span class="n">f_0</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_0</span><span class="p">)</span>
        <span class="n">f_X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">f_0</span><span class="p">,</span> <span class="n">f_1</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">negate</span><span class="p">:</span>
            <span class="n">f_X</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">return</span> <span class="n">f_X</span></div>
</div>



<div class="viewcode-block" id="CarSideImpact">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.CarSideImpact">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">CarSideImpact</span><span class="p">(</span><span class="n">MultiObjectiveTestProblem</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Car side impact problem.</span>

<span class="sd">    See [Tanabe2020]_ for details.</span>

<span class="sd">    The reference point is `nadir + 0.1 * (ideal - nadir)`</span>
<span class="sd">    where the ideal and nadir points come from the approximate</span>
<span class="sd">    Pareto frontier from [Tanabe2020]_. The max_hv was computed</span>
<span class="sd">    based on the approximate Pareto frontier from [Tanabe2020]_.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">num_objectives</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">_bounds</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.45</span><span class="p">,</span> <span class="mf">1.35</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.875</span><span class="p">,</span> <span class="mf">2.625</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">_ref_point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">45.4872</span><span class="p">,</span> <span class="mf">4.5114</span><span class="p">,</span> <span class="mf">13.3394</span><span class="p">,</span> <span class="mf">10.3942</span><span class="p">]</span>
    <span class="n">_max_hv</span> <span class="o">=</span> <span class="mf">484.72654347642793</span>

<div class="viewcode-block" id="CarSideImpact.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.CarSideImpact.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">X3</span><span class="p">,</span> <span class="n">X4</span><span class="p">,</span> <span class="n">X5</span><span class="p">,</span> <span class="n">X6</span><span class="p">,</span> <span class="n">X7</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">1.98</span>
            <span class="o">+</span> <span class="mf">4.9</span> <span class="o">*</span> <span class="n">X1</span>
            <span class="o">+</span> <span class="mf">6.67</span> <span class="o">*</span> <span class="n">X2</span>
            <span class="o">+</span> <span class="mf">6.98</span> <span class="o">*</span> <span class="n">X3</span>
            <span class="o">+</span> <span class="mf">4.01</span> <span class="o">*</span> <span class="n">X4</span>
            <span class="o">+</span> <span class="mf">1.78</span> <span class="o">*</span> <span class="n">X5</span>
            <span class="o">+</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">5</span> <span class="o">*</span> <span class="n">X6</span>
            <span class="o">+</span> <span class="mf">2.73</span> <span class="o">*</span> <span class="n">X7</span>
        <span class="p">)</span>
        <span class="n">f2</span> <span class="o">=</span> <span class="mf">4.72</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">X4</span> <span class="o">-</span> <span class="mf">0.19</span> <span class="o">*</span> <span class="n">X2</span> <span class="o">*</span> <span class="n">X3</span>
        <span class="n">V_MBP</span> <span class="o">=</span> <span class="mf">10.58</span> <span class="o">-</span> <span class="mf">0.674</span> <span class="o">*</span> <span class="n">X1</span> <span class="o">*</span> <span class="n">X2</span> <span class="o">-</span> <span class="mf">0.67275</span> <span class="o">*</span> <span class="n">X2</span>
        <span class="n">V_FD</span> <span class="o">=</span> <span class="mf">16.45</span> <span class="o">-</span> <span class="mf">0.489</span> <span class="o">*</span> <span class="n">X3</span> <span class="o">*</span> <span class="n">X7</span> <span class="o">-</span> <span class="mf">0.843</span> <span class="o">*</span> <span class="n">X5</span> <span class="o">*</span> <span class="n">X6</span>
        <span class="n">f3</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">V_MBP</span> <span class="o">+</span> <span class="n">V_FD</span><span class="p">)</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">1.16</span> <span class="o">+</span> <span class="mf">0.3717</span> <span class="o">*</span> <span class="n">X2</span> <span class="o">*</span> <span class="n">X4</span> <span class="o">+</span> <span class="mf">0.0092928</span> <span class="o">*</span> <span class="n">X3</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">0.32</span>
            <span class="o">-</span> <span class="mf">0.261</span>
            <span class="o">+</span> <span class="mf">0.0159</span> <span class="o">*</span> <span class="n">X1</span> <span class="o">*</span> <span class="n">X2</span>
            <span class="o">+</span> <span class="mf">0.06486</span> <span class="o">*</span> <span class="n">X1</span>
            <span class="o">+</span> <span class="mf">0.019</span> <span class="o">*</span> <span class="n">X2</span> <span class="o">*</span> <span class="n">X7</span>
            <span class="o">-</span> <span class="mf">0.0144</span> <span class="o">*</span> <span class="n">X3</span> <span class="o">*</span> <span class="n">X5</span>
            <span class="o">-</span> <span class="mf">0.0154464</span> <span class="o">*</span> <span class="n">X6</span>
        <span class="p">)</span>
        <span class="n">g3</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mf">0.32</span>
            <span class="o">-</span> <span class="mf">0.214</span>
            <span class="o">-</span> <span class="mf">0.00817</span> <span class="o">*</span> <span class="n">X5</span>
            <span class="o">+</span> <span class="mf">0.045195</span> <span class="o">*</span> <span class="n">X1</span>
            <span class="o">+</span> <span class="mf">0.0135168</span> <span class="o">*</span> <span class="n">X1</span>
            <span class="o">-</span> <span class="mf">0.03099</span> <span class="o">*</span> <span class="n">X2</span> <span class="o">*</span> <span class="n">X6</span>
            <span class="o">+</span> <span class="mf">0.018</span> <span class="o">*</span> <span class="n">X2</span> <span class="o">*</span> <span class="n">X7</span>
            <span class="o">-</span> <span class="mf">0.007176</span> <span class="o">*</span> <span class="n">X3</span>
            <span class="o">-</span> <span class="mf">0.023232</span> <span class="o">*</span> <span class="n">X3</span>
            <span class="o">+</span> <span class="mf">0.00364</span> <span class="o">*</span> <span class="n">X5</span> <span class="o">*</span> <span class="n">X6</span>
            <span class="o">+</span> <span class="mf">0.018</span> <span class="o">*</span> <span class="n">X2</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">g4</span> <span class="o">=</span> <span class="mf">0.32</span> <span class="o">-</span> <span class="mf">0.74</span> <span class="o">+</span> <span class="mf">0.61</span> <span class="o">*</span> <span class="n">X2</span> <span class="o">+</span> <span class="mf">0.031296</span> <span class="o">*</span> <span class="n">X3</span> <span class="o">+</span> <span class="mf">0.031872</span> <span class="o">*</span> <span class="n">X7</span> <span class="o">-</span> <span class="mf">0.227</span> <span class="o">*</span> <span class="n">X2</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">g5</span> <span class="o">=</span> <span class="mi">32</span> <span class="o">-</span> <span class="mf">28.98</span> <span class="o">-</span> <span class="mf">3.818</span> <span class="o">*</span> <span class="n">X3</span> <span class="o">+</span> <span class="mf">4.2</span> <span class="o">*</span> <span class="n">X1</span> <span class="o">*</span> <span class="n">X2</span> <span class="o">-</span> <span class="mf">1.27296</span> <span class="o">*</span> <span class="n">X6</span> <span class="o">+</span> <span class="mf">2.68065</span> <span class="o">*</span> <span class="n">X7</span>
        <span class="n">g6</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mi">32</span>
            <span class="o">-</span> <span class="mf">33.86</span>
            <span class="o">-</span> <span class="mf">2.95</span> <span class="o">*</span> <span class="n">X3</span>
            <span class="o">+</span> <span class="mf">5.057</span> <span class="o">*</span> <span class="n">X1</span> <span class="o">*</span> <span class="n">X2</span>
            <span class="o">+</span> <span class="mf">3.795</span> <span class="o">*</span> <span class="n">X2</span>
            <span class="o">+</span> <span class="mf">3.4431</span> <span class="o">*</span> <span class="n">X7</span>
            <span class="o">-</span> <span class="mf">1.45728</span>
        <span class="p">)</span>
        <span class="n">g7</span> <span class="o">=</span> <span class="mi">32</span> <span class="o">-</span> <span class="mf">46.36</span> <span class="o">+</span> <span class="mf">9.9</span> <span class="o">*</span> <span class="n">X2</span> <span class="o">+</span> <span class="mf">4.4505</span> <span class="o">*</span> <span class="n">X1</span>
        <span class="n">g8</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">-</span> <span class="n">f2</span>
        <span class="n">g9</span> <span class="o">=</span> <span class="mf">9.9</span> <span class="o">-</span> <span class="n">V_MBP</span>
        <span class="n">g10</span> <span class="o">=</span> <span class="mf">15.7</span> <span class="o">-</span> <span class="n">V_FD</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">,</span> <span class="n">g3</span><span class="p">,</span> <span class="n">g4</span><span class="p">,</span> <span class="n">g5</span><span class="p">,</span> <span class="n">g6</span><span class="p">,</span> <span class="n">g7</span><span class="p">,</span> <span class="n">g8</span><span class="p">,</span> <span class="n">g9</span><span class="p">,</span> <span class="n">g10</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">zero</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">g</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">g</span><span class="p">,</span> <span class="n">zero</span><span class="p">)</span>
        <span class="n">f4</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span><span class="p">,</span> <span class="n">f4</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>
</div>



<span class="c1"># ------ Constrained Multi-Objective Test Problems ----- #</span>


<div class="viewcode-block" id="BNH">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.BNH">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">BNH</span><span class="p">(</span><span class="n">MultiObjectiveTestProblem</span><span class="p">,</span> <span class="n">ConstrainedBaseTestProblem</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The constrained BNH problem.</span>

<span class="sd">    See [GarridoMerchan2020]_ for more details on this problem. Note that this is a</span>
<span class="sd">    minimization problem.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dim</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">num_objectives</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">num_constraints</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)]</span>
    <span class="n">_ref_point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>  <span class="c1"># TODO: Determine proper reference point</span>

<div class="viewcode-block" id="BNH.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.BNH.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
            <span class="p">[</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">X</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="mf">5.0</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="BNH.evaluate_slack_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.BNH.evaluate_slack_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_slack_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="mf">25.0</span> <span class="o">-</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">5.0</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">8.0</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">3.0</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">7.7</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="CONSTR">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.CONSTR">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">CONSTR</span><span class="p">(</span><span class="n">MultiObjectiveTestProblem</span><span class="p">,</span> <span class="n">ConstrainedBaseTestProblem</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The constrained CONSTR problem.</span>

<span class="sd">    See [GarridoMerchan2020]_ for more details on this problem. Note that this is a</span>
<span class="sd">    minimization problem.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dim</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">num_objectives</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">num_constraints</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)]</span>
    <span class="n">_ref_point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]</span>

<div class="viewcode-block" id="CONSTR.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.CONSTR.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">obj1</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">obj2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">obj1</span><span class="p">,</span> <span class="n">obj2</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="CONSTR.evaluate_slack_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.CONSTR.evaluate_slack_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_slack_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="mf">9.0</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">6.0</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="mf">9.0</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="ConstrainedBraninCurrin">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.ConstrainedBraninCurrin">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">ConstrainedBraninCurrin</span><span class="p">(</span><span class="n">BraninCurrin</span><span class="p">,</span> <span class="n">ConstrainedBaseTestProblem</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Constrained Branin Currin Function.</span>

<span class="sd">    This uses the disk constraint from [Gelbart2014]_.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dim</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">num_objectives</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">num_constraints</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)]</span>
    <span class="n">_con_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">)]</span>
    <span class="n">_ref_point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">80.0</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">]</span>
    <span class="n">_max_hv</span> <span class="o">=</span> <span class="mf">608.4004237022673</span>  <span class="c1"># from NSGA-II with 90k evaluations</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">noise_std</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">constraint_noise_std</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">negate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">dtype</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">double</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            noise_std: Standard deviation of the observation noise of the objectives.</span>
<span class="sd">            constraint_noise_std: Standard deviation of the observation noise of the</span>
<span class="sd">                constraint.</span>
<span class="sd">            negate: If True, negate the function.</span>
<span class="sd">            dtype: The dtype that is used for the bounds of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">noise_std</span><span class="o">=</span><span class="n">noise_std</span><span class="p">,</span> <span class="n">negate</span><span class="o">=</span><span class="n">negate</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">con_bounds</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_con_bounds</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
            <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">register_buffer</span><span class="p">(</span><span class="s2">&quot;con_bounds&quot;</span><span class="p">,</span> <span class="n">con_bounds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constraint_noise_std</span> <span class="o">=</span> <span class="n">constraint_noise_std</span>

<div class="viewcode-block" id="ConstrainedBraninCurrin.evaluate_slack_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.ConstrainedBraninCurrin.evaluate_slack_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_slack_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">X_tf</span> <span class="o">=</span> <span class="n">unnormalize</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">con_bounds</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">50</span> <span class="o">-</span> <span class="p">(</span><span class="n">X_tf</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">2.5</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">X_tf</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mf">7.5</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="C2DTLZ2">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.C2DTLZ2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">C2DTLZ2</span><span class="p">(</span><span class="n">DTLZ2</span><span class="p">,</span> <span class="n">ConstrainedBaseTestProblem</span><span class="p">):</span>
    <span class="n">num_constraints</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">_r</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="c1"># approximate from nsga-ii, TODO: replace with analytic</span>
    <span class="n">_max_hv</span> <span class="o">=</span> <span class="mf">0.3996406303723544</span>

<div class="viewcode-block" id="C2DTLZ2.evaluate_slack_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.C2DTLZ2.evaluate_slack_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_slack_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Batch X is not supported.&quot;</span><span class="p">)</span>
        <span class="n">f_X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate_true</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">term1</span> <span class="o">=</span> <span class="p">(</span><span class="n">f_X</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="o">~</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">f_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="n">f_X</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">bool</span><span class="p">())</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">f_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="n">f_X</span><span class="o">.</span><span class="n">device</span><span class="p">)</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">f_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">indexer</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">f_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">f_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">term2_inner</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">f_X</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">f_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">f_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">f_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">indexer</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">f_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">term2</span> <span class="o">=</span> <span class="p">(</span><span class="n">term2_inner</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">min1</span> <span class="o">=</span> <span class="p">(</span><span class="n">term1</span> <span class="o">+</span> <span class="n">term2</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
        <span class="n">min2</span> <span class="o">=</span> <span class="p">((</span><span class="n">f_X</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">f_X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">torch</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">min1</span><span class="p">,</span> <span class="n">min2</span><span class="p">)</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="DiscBrake">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DiscBrake">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">DiscBrake</span><span class="p">(</span><span class="n">MultiObjectiveTestProblem</span><span class="p">,</span> <span class="n">ConstrainedBaseTestProblem</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The Disc Brake problem.</span>

<span class="sd">    There are 2 objectives and 4 constraints.</span>

<span class="sd">    Both objectives should be minimized.</span>

<span class="sd">    See [Tanabe2020]_ for details.</span>

<span class="sd">    The reference point was set using the `infer_reference_point`</span>
<span class="sd">    heuristic on the Pareto frontier over a large discrete set of</span>
<span class="sd">    random designs.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dim</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">num_objectives</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">num_constraints</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">55.0</span><span class="p">,</span> <span class="mf">80.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">75.0</span><span class="p">,</span> <span class="mf">110.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">1000.0</span><span class="p">,</span> <span class="mf">3000.0</span><span class="p">),</span> <span class="p">(</span><span class="mf">11.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">)]</span>
    <span class="n">_ref_point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.7771</span><span class="p">,</span> <span class="mf">3.9651</span><span class="p">]</span>

<div class="viewcode-block" id="DiscBrake.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DiscBrake.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
            <span class="o">*</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_objectives</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">device</span>
        <span class="p">)</span>

        <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">X3</span><span class="p">,</span> <span class="n">X4</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">sq_diff</span> <span class="o">=</span> <span class="n">X2</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">X1</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">f</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.9</span> <span class="o">*</span> <span class="mf">1e-5</span> <span class="o">*</span> <span class="n">sq_diff</span> <span class="o">*</span> <span class="p">(</span><span class="n">X4</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">f</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">9.82</span> <span class="o">*</span> <span class="mf">1e6</span><span class="p">)</span> <span class="o">*</span> <span class="n">sq_diff</span> <span class="o">/</span> <span class="p">(</span><span class="n">X3</span> <span class="o">*</span> <span class="n">X4</span> <span class="o">*</span> <span class="p">(</span><span class="n">X2</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">X1</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>

        <span class="k">return</span> <span class="n">f</span></div>


<div class="viewcode-block" id="DiscBrake.evaluate_slack_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.DiscBrake.evaluate_slack_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_slack_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
            <span class="o">*</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_constraints</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">device</span>
        <span class="p">)</span>
        <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">X3</span><span class="p">,</span> <span class="n">X4</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">sq_diff</span> <span class="o">=</span> <span class="n">X2</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">X1</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">cub_diff</span> <span class="o">=</span> <span class="n">X2</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">-</span> <span class="n">X1</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">g</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">X2</span> <span class="o">-</span> <span class="n">X1</span> <span class="o">-</span> <span class="mf">20.0</span>
        <span class="n">g</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.4</span> <span class="o">-</span> <span class="n">X3</span> <span class="o">/</span> <span class="p">(</span><span class="mf">3.14</span> <span class="o">*</span> <span class="n">sq_diff</span><span class="p">)</span>
        <span class="n">g</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="p">(</span><span class="mf">2.22</span> <span class="o">*</span> <span class="mf">1e-3</span> <span class="o">*</span> <span class="n">X3</span> <span class="o">*</span> <span class="n">cub_diff</span><span class="p">)</span> <span class="o">/</span> <span class="n">sq_diff</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">g</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">:]</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.66</span> <span class="o">*</span> <span class="mf">1e-2</span> <span class="o">*</span> <span class="n">X3</span> <span class="o">*</span> <span class="n">X4</span> <span class="o">*</span> <span class="n">cub_diff</span><span class="p">)</span> <span class="o">/</span> <span class="n">sq_diff</span> <span class="o">-</span> <span class="mf">900.0</span>
        <span class="k">return</span> <span class="n">g</span></div>
</div>



<div class="viewcode-block" id="MW7">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.MW7">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">MW7</span><span class="p">(</span><span class="n">MultiObjectiveTestProblem</span><span class="p">,</span> <span class="n">ConstrainedBaseTestProblem</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The MW7 problem.</span>

<span class="sd">    This problem has 2 objectives, 2 constraints, and a disconnected Pareto</span>
<span class="sd">    frontier. It supports arbitrary input dimension &gt; 1. See [Ma2019]_ for details.</span>

<span class="sd">    This implementation is adapted from:</span>
<span class="sd">    https://github.com/anyoptimization/pymoo/blob/master/pymoo/problems/multi/mw.py</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">num_constraints</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">num_objectives</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">_ref_point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">noise_std</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">constraint_noise_std</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">negate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">dtype</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">double</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            dim: The (input) dimension of the function. Must be at least 2.</span>
<span class="sd">            noise_std: Standard deviation of the observation noise of the objectives.</span>
<span class="sd">            constraint_noise_std: Standard deviation of the observation noise of the</span>
<span class="sd">                constraints.</span>
<span class="sd">            negate: If True, negate the function.</span>
<span class="sd">            dtype: The dtype that is used for the bounds of the function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">dim</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dim must be greater than or equal to 2.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="n">dim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dim</span><span class="p">)]</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">noise_std</span><span class="o">=</span><span class="n">noise_std</span><span class="p">,</span> <span class="n">negate</span><span class="o">=</span><span class="n">negate</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constraint_noise_std</span> <span class="o">=</span> <span class="n">constraint_noise_std</span>

<div class="viewcode-block" id="MW7.LA2">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.MW7.LA2">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">LA2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">A</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">B</span> <span class="o">*</span> <span class="n">theta</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">C</span><span class="p">))</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">D</span><span class="p">)</span></div>


<div class="viewcode-block" id="MW7.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.MW7.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span>
        <span class="n">contrib</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">g</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">contrib</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">f0</span> <span class="o">=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">f0</span> <span class="o">/</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">f0</span><span class="p">,</span> <span class="n">f1</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="MW7.evaluate_slack_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.MW7.evaluate_slack_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_slack_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">ff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate_true</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">f0</span><span class="p">,</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">ff</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">ff</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">atan</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">f1</span> <span class="o">/</span> <span class="n">f0</span><span class="p">)</span>
        <span class="n">g0</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">f0</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="o">+</span> <span class="n">f1</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="o">-</span> <span class="p">(</span><span class="mf">1.2</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LA2</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">16.0</span><span class="p">,</span> <span class="n">atan</span><span class="p">))</span><span class="o">.</span><span class="n">abs</span><span class="p">())</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.15</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">LA2</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="n">atan</span><span class="p">))</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">f0</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">f1</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">g0</span><span class="p">,</span> <span class="n">g1</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="OSY">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.OSY">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">OSY</span><span class="p">(</span><span class="n">MultiObjectiveTestProblem</span><span class="p">,</span> <span class="n">ConstrainedBaseTestProblem</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The OSY test problem from [Oszycka1995]_.</span>
<span class="sd">    Implementation from</span>
<span class="sd">    https://github.com/msu-coinlab/pymoo/blob/master/pymoo/problems/multi/osy.py</span>
<span class="sd">    Note that this implementation assumes minimization, so please choose negate=True.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dim</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">num_constraints</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">num_objectives</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">_bounds</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">_ref_point</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">75.0</span><span class="p">,</span> <span class="mf">75.0</span><span class="p">]</span>

<div class="viewcode-block" id="OSY.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.OSY.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span>
            <span class="mi">25</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="o">+</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="o">+</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="o">+</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="o">+</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">f2</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="OSY.evaluate_slack_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.OSY.evaluate_slack_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_slack_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">g1</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">2.0</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="mf">6.0</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">g3</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">g4</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">3.0</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">g5</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">-</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mf">3.0</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
        <span class="n">g6</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">-</span> <span class="mf">3.0</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">-</span> <span class="mf">4.0</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">,</span> <span class="n">g3</span><span class="p">,</span> <span class="n">g4</span><span class="p">,</span> <span class="n">g5</span><span class="p">,</span> <span class="n">g6</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="SRN">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.SRN">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">SRN</span><span class="p">(</span><span class="n">MultiObjectiveTestProblem</span><span class="p">,</span> <span class="n">ConstrainedBaseTestProblem</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;The constrained SRN problem.</span>

<span class="sd">    See [GarridoMerchan2020]_ for more details on this problem. Note that this is a</span>
<span class="sd">    minimization problem.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dim</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">num_objectives</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">num_constraints</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">_bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mf">20.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">20.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">)]</span>
    <span class="n">_ref_point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>  <span class="c1"># TODO: Determine proper reference point</span>

<div class="viewcode-block" id="SRN.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.SRN.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">obj1</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="mf">2.0</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">obj2</span> <span class="o">=</span> <span class="mf">9.0</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">obj1</span><span class="p">,</span> <span class="n">obj2</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="SRN.evaluate_slack_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.SRN.evaluate_slack_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_slack_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="mf">225.0</span> <span class="o">-</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10.0</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="WeldedBeam">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.WeldedBeam">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">WeldedBeam</span><span class="p">(</span><span class="n">MultiObjectiveTestProblem</span><span class="p">,</span> <span class="n">ConstrainedBaseTestProblem</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The Welded Beam multi-objective test problem. Similar to `WeldedBeamSO` in</span>
<span class="sd">    `botorch.test_function.synthetic`, but with an additional output, somewhat</span>
<span class="sd">    modified constraints, and a different domain.</span>

<span class="sd">    Implementation from</span>
<span class="sd">    https://github.com/msu-coinlab/pymoo/blob/master/pymoo/problems/multi/welded_beam.py</span>
<span class="sd">    Note that this implementation assumes minimization, so please choose negate=True.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dim</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">num_constraints</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">num_objectives</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">_bounds</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="mf">0.125</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">0.125</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">_ref_point</span> <span class="o">=</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mf">0.015</span><span class="p">]</span>

<div class="viewcode-block" id="WeldedBeam.evaluate_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.WeldedBeam.evaluate_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="c1"># We could do the following, but the constraints are using somewhat</span>
        <span class="c1"># different numbers (see below).</span>
        <span class="c1"># f1 = WeldedBeam.evaluate_true(self, X)</span>
        <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="mf">1.10471</span> <span class="o">*</span> <span class="n">x1</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">+</span> <span class="mf">0.04811</span> <span class="o">*</span> <span class="n">x3</span> <span class="o">*</span> <span class="n">x4</span> <span class="o">*</span> <span class="p">(</span><span class="mf">14.0</span> <span class="o">+</span> <span class="n">x2</span><span class="p">)</span>
        <span class="n">f2</span> <span class="o">=</span> <span class="mf">2.1952</span> <span class="o">/</span> <span class="p">(</span><span class="n">x4</span> <span class="o">*</span> <span class="n">x3</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="WeldedBeam.evaluate_slack_true">
<a class="viewcode-back" href="../../../test_functions.html#botorch.test_functions.multi_objective.WeldedBeam.evaluate_slack_true">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">evaluate_slack_true</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
        <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">,</span> <span class="n">x4</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">P</span> <span class="o">=</span> <span class="mf">6000.0</span>
        <span class="n">L</span> <span class="o">=</span> <span class="mf">14.0</span>
        <span class="n">t_max</span> <span class="o">=</span> <span class="mf">13600.0</span>
        <span class="n">s_max</span> <span class="o">=</span> <span class="mf">30000.0</span>

        <span class="c1"># Ideally, we could just do the following, but the numbers in the</span>
        <span class="c1"># single-outcome WeldedBeam are different (see below)</span>
        <span class="c1"># g1_, g2_, g3_, _, _, g6_ = WeldedBeam.evaluate_slack_true(self, X)</span>
        <span class="c1"># g1 = g1_ / t_max</span>
        <span class="c1"># g2 = g2_ / s_max</span>
        <span class="c1"># g3 = 1 / (5 - 0.125) * g3_</span>
        <span class="c1"># g4 = 1 / P * g6_</span>

        <span class="n">R</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x3</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">P</span> <span class="o">*</span> <span class="p">(</span><span class="n">L</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="c1"># This `J` is different than the one in [CoelloCoello2002constraint]_</span>
        <span class="c1"># by a factor of 2 (sqrt(2) instead of sqrt(0.5))</span>
        <span class="n">J</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">12</span> <span class="o">+</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">x3</span><span class="p">)</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">P</span> <span class="o">/</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">x1</span> <span class="o">*</span> <span class="n">x2</span><span class="p">)</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="n">M</span> <span class="o">*</span> <span class="n">R</span> <span class="o">/</span> <span class="n">J</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">t1</span> <span class="o">*</span> <span class="n">t2</span> <span class="o">*</span> <span class="n">x2</span> <span class="o">/</span> <span class="n">R</span> <span class="o">+</span> <span class="n">t2</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">P</span> <span class="o">*</span> <span class="n">L</span> <span class="o">/</span> <span class="p">(</span><span class="n">x4</span> <span class="o">*</span> <span class="n">x3</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
        <span class="c1"># These numbers are also different from [CoelloCoello2002constraint]_</span>
        <span class="n">P_c</span> <span class="o">=</span> <span class="mf">64746.022</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.0282346</span> <span class="o">*</span> <span class="n">x3</span><span class="p">)</span> <span class="o">*</span> <span class="n">x3</span> <span class="o">*</span> <span class="n">x4</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

        <span class="n">g1</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">t_max</span><span class="p">)</span> <span class="o">/</span> <span class="n">t_max</span>
        <span class="n">g2</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="n">s_max</span><span class="p">)</span> <span class="o">/</span> <span class="n">s_max</span>
        <span class="n">g3</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="mf">0.125</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x4</span><span class="p">)</span>
        <span class="n">g4</span> <span class="o">=</span> <span class="p">(</span><span class="n">P</span> <span class="o">-</span> <span class="n">P_c</span><span class="p">)</span> <span class="o">/</span> <span class="n">P</span>

        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">g1</span><span class="p">,</span> <span class="n">g2</span><span class="p">,</span> <span class="n">g3</span><span class="p">,</span> <span class="n">g4</span><span class="p">],</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>